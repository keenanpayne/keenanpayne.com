{# Component Settings #}
{% set project = section.project %}
{% set name = section.name %}
{% set items = section.items %}
{% set source = section.source %}
{% set contained = section.contained %}
{% set enlarge = section.enlarge %}
{% set headline = section.headline %}
{% set description = section.description %}
{% set eyebrow = section.eyebrow %}

{% if source == 'dribbble' %}
  {% set query = portfolio[project].dribbble %}
{% elif source == 'assets' %}
  {% set query = portfolio[project].assets %}
{% endif %}

{# Markup #}
{%- if items -%}
  <div class="portfolioGrid {{ section.modifier }}">
    {% if headline or description %}
      <header class="portfolioGrid-header">
        {% if eyebrow %}
          <p class="portfolioGrid-label _label">
            {{ eyebrow }}
          </p>
        {% endif %}

        {% if headline %}
          <h2 class="portfolioGrid-headline">
            {{ headline }}
          </h2>
        {% endif %}

        {% if description %}
          <p class="_text-h5">
            {{ description | nl2br | safe }}
          </p>
        {% endif %}
      </header>
    {% endif %}

    <div class="portfolioGrid-items">
      {%- for item in items -%}
        {% set res = query[item] %}
        {% set video = res.video %}
        {% set image = res.image %}
        {% set title = res.title %}
        {% set description = res.description %}
        {% set link = res.link %}

        <div class="portfolioGrid-item">
          {# TODO: Lazy-load asset and host on an asset management platform #}
          {%- if video -%}
            <video muted controls src="{{ video }}"></video>
          {%- endif -%}

          {%- if image -%}
            {% if contained %}
              {# TODO: Lazy-load this background image #}
              <a href="{{ image }}" title="Enlarge image for {{ title }}" class="portfolioGrid-imageTile" style="--background: url({{ image }})"></a>
            {% else %}
              <img src="{{ image }}" alt="{{ title }}" loading="lazy" />
            {% endif%}
          {%- endif -%}

          {% if title %}
            <h3 class="portfolioGrid-title {% if contained %} _text-h5 {% else %} _text-h4 {% endif %}">
              {%- if link -%}
                <a class="portfolioGrid-link" href="{{ link }}" target="_blank" rel="noopener">
              {%- endif -%}

              {%- if title -%}
                {{ title }}
              {%- endif -%}

              {%- if link -%}
                </a>
              {%- endif -%}

              {% if enlarge %}
                <a title="Enlarge image for {{ title }}" href="{{ image }}" class="portfolioGrid-enlarge">
                  <span class="_hidden">
                    Enlarge image for {{ title }}
                  </span>

                  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512">
                    <path d="M416 208c0 45.9-14.9 88.3-40 122.7L502.6 457.4c12.5 12.5 12.5 32.8 0 45.3s-32.8 12.5-45.3 0L330.7 376c-34.4 25.2-76.8 40-122.7 40C93.1 416 0 322.9 0 208S93.1 0 208 0S416 93.1 416 208zM184 296c0 13.3 10.7 24 24 24s24-10.7 24-24V232h64c13.3 0 24-10.7 24-24s-10.7-24-24-24H232V120c0-13.3-10.7-24-24-24s-24 10.7-24 24v64H120c-13.3 0-24 10.7-24 24s10.7 24 24 24h64v64z"/>
                  </svg>
                </a>
              {% endif %}
            </h3>
          {% endif %}

          {% if description %}
            <p class="portfolioGrid-description _text-h6">
              {{ description }}
            </p>
          {% endif %}

        </div>
      {%- endfor -%}
    </div>
  </div>
{%- endif -%}